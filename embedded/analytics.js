"use strict";(function(){const r="application/json",c=["1","yes"];function w(){const n=document.referrer;if(!n)return"";try{return new URL(n).host===window.location.host?"":n}catch{return""}}function o(n,e){(function(d,f){const p=JSON.stringify(d);if(typeof navigator.sendBeacon=="function"){const g=new Blob([p],{type:r});if(navigator.sendBeacon(f,g))return}fetch(f,{method:"POST",headers:{"Content-Type":r},body:p,keepalive:!0}).catch(()=>{})})((function(d){return{path:window.location.pathname,referrer:w(),screen_size:`${window.innerWidth}x${window.innerHeight}`,user_agent:navigator.userAgent,duration_sec:Math.max(0,Math.round(d))}})(n),e)}const t={pageLoadTime:0,isInitialized:!1};let a=!1;const i={endpoint:(function(){const n=document.currentScript;if(!n)return"";const e=n.src;if(!e)return"";try{return new URL(e).origin}catch{return""}})()+"/api/analytics/collect",doNotTrack:(function(){const n=navigator.doNotTrack,e=window.doNotTrack;return c.includes(n||"")||c.includes(e||"")})()};function u(){t.pageLoadTime=Date.now(),t.isInitialized=!0,o(0,i.endpoint)}function s(){t.isInitialized&&!a&&(a=!0,o((Date.now()-t.pageLoadTime)/1e3,i.endpoint))}function l(n){(function(e){return e.type==="htmx:afterSwap"&&"detail"in e&&e.detail!==null&&typeof e.detail=="object"&&"target"in e.detail})(n)&&n.detail.target.id==="main-content"&&t.isInitialized&&(o((Date.now()-t.pageLoadTime)/1e3,i.endpoint),t.pageLoadTime=Date.now(),a=!1,setTimeout(()=>o(0,i.endpoint),10))}typeof window<"u"&&typeof document<"u"&&typeof navigator<"u"&&(i.doNotTrack||(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u(),window.addEventListener("beforeunload",s),window.addEventListener("pagehide",s),window.htmx&&document.addEventListener("htmx:afterSwap",l),window.Nanolytica={track:()=>{t.pageLoadTime=Date.now(),o(0,i.endpoint)}}))})();
